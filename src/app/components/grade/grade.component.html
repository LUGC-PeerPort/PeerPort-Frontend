<section class="whole-page">
  <section class="CourseGrades">
    <h1>{{courseName}}</h1>
    <h3>Course Average: {{averageGrade}}</h3>
    <h3 *ngIf="student">Your Grade: {{studentGrade}}</h3>

    <ul class="assignmentList" *ngIf="assignments.length">
      <li *ngFor="let assignment of assignments; let i = index">
        <input type="checkbox" [id]="'toggle-box-' + i" class="toggle-checkbox">
        <div class="assignment-color">
          <label [for]="'toggle-box-' + i" class="toggle-label">{{assignment.name}}</label>
          <img src="arrow-down-solid-full.svg" class="arrow-toggle" width="10px" height="20px">
        </div>

        <div class="collapsible-content">
          <ul class="submissionsForAssignment">
            <li *ngFor="let submission of assignment.submissions; let j = index">
              <h4 *ngIf="!student">Student: {{getUserName(submission.userId)}}</h4>
              <p>Grade: {{calculateGrade(submission.grade) != null ? calculateGrade(submission.grade) + "%" : 'Not graded'}}</p>
              <p>Submitted on: {{submission.timeSubmitted}}</p>
              <p *ngIf="submission.comment">Comment: {{submission.comment}}</p>
              <iframe *ngFor="let file of submission.files" [src]="file.url"></iframe>
              <button [id]="'grade-button-' + j" *ngIf="getGradeId(submission.assignmentSubmissionId) === null && !student" (click)="togglePopUp(submission.assignmentSubmissionId); activity = createGrade">Grade</button>
              <button [id]="'edit-grade-button' + j" *ngIf="getGradeId(submission.assignmentSubmissionId) !== null && !student" (click)="togglePopUp(submission.assignmentSubmissionId); activity = updateGrade">Edit Grade</button>
              <button [id]="'delete-grade-button' + j" *ngIf="getGradeId(submission.assignmentSubmissionId) !== null && !student" (click)="deleteGrade(submission.assignmentSubmissionId)">Delete</button>
            </li>
          </ul>
        </div>
      </li>
    </ul>
  </section>


  <section class="gradePopup-background" *ngIf="isPopUpOpen">
      <div class="gradePopup-foreground">
          <form (ngSubmit)="activity()"> 
              <label for="minScore">Minimum Score</label>
              <input id="minScore" type="number" [(ngModel)]="minScore" name="minScore">
              
              <label for="maxScore">Maximum Score</label>
              <input id="maxScore" type="number" [(ngModel)]="maxScore" name="maxScore">

              <label for="achievedScore">Achieved Score</label>
              <input id="achievedScore" type="number" [(ngModel)]="achievedScore" name="achievedScore">

              <label for="weight">Weight</label>
              <input id="weight" type="number" [(ngModel)]="weight" name="weight">
              <button type="submit">Submit</button>
          </form>
          <button (click)="togglePopUp(submissionId)">Close</button>
      </div>
  </section>
</section>